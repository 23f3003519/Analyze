<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Project with GitHub Actions CI/CD</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 960px;
            margin-top: 40px;
            margin-bottom: 40px;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        }
        h1, h2, h3 {
            color: #0056b3;
            margin-bottom: 20px;
        }
        .file-section {
            margin-bottom: 30px;
            padding: 15px;
            background-color: #e9ecef;
            border-left: 5px solid #007bff;
            border-radius: 5px;
        }
        .file-section h3 {
            color: #007bff;
            margin-top: 0;
            margin-bottom: 15px;
        }
        .file-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        .file-item a {
            margin-left: 10px;
        }
        .code-block {
            background-color: #f4f4f4;
            border: 1px solid #ddd;
            padding: 15px;
            margin-top: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .alert-info {
            background-color: #d1ecf1;
            border-color: #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center">Python Data Processing with GitHub Actions</h1>
        <p class="lead text-center">This project demonstrates a minimal Python application for data processing, integrated with a GitHub Actions CI/CD pipeline to lint code, execute the script, and publish results to GitHub Pages.</p>

        <hr>

        <div class="file-section">
            <h3>Project Files</h3>
            <p>Below are the core project files, ready for download and use in your repository:</p>

            <div class="file-item">
                <strong><code>execute.py</code> (Fixed):</strong>
                <a href="data:text/x-python;base64,aW1wb3J0IGpzb24KCmltcG9ydCBwYW5kYXMgYXMgcGQKCgpkZWYgbWFpbigpOgogICAgIyBSZWFkIHRoZSBDU1YgZmlsZQogICAgZGYgPSBwZC5yZWFkX2NzdignZGF0YS5jc3YnKQoKICAgICMgQ2FsY3VsYXRlIHRvdGFsIHJldmVudWUgcGVyIHByb2R1Y3QKICAgIHByb2R1Y3RfcmV2ZW51ZSA9IGRmLmdyb3VwYnkoJ1Byb2R1Y3QnKVsnU2FsZXMnXS5zdW0oKS5yZXNldF9pbmRleCgpCiAgICBwcm9kdWN0X3JldmVudWUucmVwYW5lKGNvbHVtbnM9eydTYWxlcyc6ICdUb3RhbFJldmVudWUrfSwgaW5wbGFjZT1UcnVlKQoKICAgICMgQ2FsY3VsYXRlIGF2ZXJhZ2UgcHJvZml0IG1hcmdpbgogICAgZGZbJ1Byb2ZpdE1hcmdpbicgPSAoZGZbJ1Byb2ZpdCddIC8gZGZbJ1NhbGVzJ10pICogMTAwCiAgICBhdmVyYWdlX3Byb2ZpdF9tYXJnaW4gPSBkZlsnUHJvZml0TWFyZ2luJ10ubWVhbigpCgogICAgIyBQcmVwYXJlIHJlc3VsdHMKICAgIHJlc3VsdHMgPSB7CiAgICAgICAgJ3RvdGFsX3JldmVudWVfcGVyX3Byb2R1Y3QnOiBwcm9kdWN0X3JldmVudWUudG9fZGljdChvcmllbnQ9J3JlY29yZHMnKSwKICAgICAgICAnYXZlcmFnZV9wcm9maXRfbWFyZ2luJzogcm91bmQoYXZlcmFnZV9wcm9maXRfbWFyZ2luLCAyKQogICAgfQoKICAgICMgT3V0cHV0IHRvIEpTT04KICAgIHdpdGggb3BlbigncmVzdWx0Lmpzb24nLCAndycpIGFzIGY6CiAgICAgICAganNvbi5kdW1wKHJlc3VsdHMsIGYsIGluZGVudD00KQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIG1haW4oKQo=" download="execute.py" class="btn btn-primary btn-sm">Download execute.py</a>
                <span class="ms-3 text-success">Non-trivial error ("revenew" typo) has been fixed.</span>
                <details class="ms-3">
                    <summary>View Content</summary>
                    <pre class="code-block"><code>import json

import pandas as pd

def main():
    # Read the CSV file
    df = pd.read_csv('data.csv')

    # Calculate total revenue per product
    product_revenue = df.groupby('Product')['Sales'].sum().reset_index()
    product_revenue.rename(columns={'Sales': 'TotalRevenue'}, inplace=True)

    # Calculate average profit margin
    df['ProfitMargin'] = (df['Profit'] / df['Sales']) * 100
    average_profit_margin = df['ProfitMargin'].mean()

    # Prepare results
    results = {
        'total_revenue_per_product': product_revenue.to_dict(orient='records'),
        'average_profit_margin': round(average_profit_margin, 2)
    }

    # Output to JSON
    with open('result.json', 'w') as f:
        json.dump(results, f, indent=4)

if __name__ == '__main__':
    main()
</code></pre>
                </details>
            </div>

            <div class="file-item">
                <strong><code>data.csv</code>:</strong>
                <a href="data:text/csv;base64,UHJvZHVjdCxTYWxlcyxQcm9maXQKUywxMDAsMjAKQiwxNTAsMzAKQywyMDAsNDAKQSwxMjAsMjUKQiwxODAsMzUKQywyMjAsNDUK" download="data.csv" class="btn btn-primary btn-sm">Download data.csv</a>
                <span class="ms-3 text-success">Converted from <code>data.xlsx</code>.</span>
                <details class="ms-3">
                    <summary>View Content</summary>
                    <pre class="code-block"><code>Product,Sales,Profit
A,100,20
B,150,30
C,200,40
A,120,25
B,180,35
C,220,45
</code></pre>
                </details>
            </div>

            <div class="file-item">
                <strong><code>.github/workflows/ci.yml</code>:</strong>
                <a href="data:text/yaml;base64,bmFtZTogQ0kvQ0QgcGlwZWxpbmUKCm9uOgogIHB1c2g6CiAgICBicmFuY2hlczoKICAgICAgLSBtYWluICMgb3IgbWFzdGVyLCBkZXBlbmRpbmcgb24geW91ciBkZWZhdWx0IGJyYW5jaAoKICBqb2JzOgogICAgYnVpbGQtYW5kLWRlcGxveToKICAgICAgcnVucy1vbjogdWJ1bnR1LWxhdGVzdAogICAgICBwZXJtaXNzaW9uczoKICAgICAgICBjb250ZW50czogcmVhZ对面cKICAgICAgICBwYWdlczogd3JpdGUKICAgICAgICBpZC10b2tlbjogd3JpdGUKCiAgICAgIHN0ZXBzOgogICAgICAgIC0gbmFtZTogQ2hlY2tvdXQgcmVwb3NpdG9yeQogICAgICAgICAgdXNlczogYWN0aW9ucy9jaGVja291dEB2NAoKICAgICAgICAtIG5hbWU6IFNldCB1cCBQeXRob24gMy4xMQogICAgICAgICAgdXNlczogYWN0aW9ucy9zZXR1cC1weXRob25AdjUKICAgICAgICAgIHdpdGg6CiAgICAgICAgICAgIHB5dGhvbi12ZXJzaW9uOiAnMy4xMScKCiAgICAgICAgICAtIG5hbWU6IEluc3RhbGwgZGVwZW5kZW5jaWVzCiAgICAgICAgICAgIHJ1bjogfAogICAgICAgICAgICAgIHB5dGhvbiAtbSBwaXAgaW5zdGFsbCAtLXVwZ3JhZGUgcGlwCiAgICAgICAgICAgICAgcGlwIGluc3RhbGwgcGFuZGFzPTIuMyBydWZmCgogICAgICAgICAgLSBuYW1lOiBSdW4gUnVmZiBMaW50ZXIKICAgICAgICAgICAgcnVuOiBydWZmIGNoZWNrIC4KCgogICAgICAgICAgLSBuYW1lOiBFeGVjdXRlIFB5dGhvbiBzY3JpcHQKICAgICAgICAgICAgcnVuOiBweXRob24gZXhlY3V0ZS5weSA+IHJlc3VsdC5qc29uCgogICAgICAgICAgLSBuYW1lOiBVcGxvYWQgYXJ0aWZhY3QgZm9yIEdpdEh1YiBQYWdlcwogICAgICAgICAgICB1c2VzOiBhY3Rpb25zL3VwbG9hZC1wYWdlcy1hcnRpZmFjdEB2MwogICAgICAgICAgICB3aXRoOgogICAgICAgICAgICAgIHBhdGg6ICdyZXN1bHQuanNvbicgIyBQYXRoIHRvIHRoZSBmaWxlIHRvIHB1Ymxpc2gKCiAgICAgICAgICAtIG5hbWU6IERlcGxveSB0byBHaXRIdWIgUGFnZXMKICAgICAgICAgICAgaWQ6IGRlcGxveW1lbnQKICAgICAgICAgICAgdXNlczogYWN0aW9ucy9kZXBsb3ktcGFnZXNAdjQK" download="ci.yml" class="btn btn-primary btn-sm">Download ci.yml</a>
                <span class="ms-3 text-success">GitHub Actions workflow for CI/CD.</span>
                <details class="ms-3">
                    <summary>View Content</summary>
                    <pre class="code-block"><code>name: CI/CD Pipeline

on:
  push:
    branches:
      - main # or master, depending on your default branch

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pages: write
      id-token: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pandas==2.3 ruff

      - name: Run Ruff Linter
        run: ruff check .

      - name: Execute Python script
        run: python execute.py > result.json

      - name: Upload artifact for GitHub Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: 'result.json' # Path to the file to publish

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
</code></pre>
                </details>
            </div>
        </div>

        <div class="file-section">
            <h3>GitHub Actions Workflow Details</h3>
            <p>The <code>ci.yml</code> workflow is configured to run on every push to the <code>main</code> branch. It performs the following steps:</p>
            <ol>
                <li><strong>Checkout repository:</strong> Fetches your code.</li>
                <li><strong>Set up Python 3.11:</strong> Ensures the environment is set up with the specified Python version.</li>
                <li><strong>Install dependencies:</strong> Installs <code>pandas==2.3</code> and <code>ruff</code>.</li>
                <li><strong>Run Ruff Linter:</strong> Executes <code>ruff check .</code> to lint the Python code and shows results in the CI log.</li>
                <li><strong>Execute Python script:</strong> Runs <code>python execute.py</code> and redirects its output to <code>result.json</code>.</li>
                <li><strong>Upload artifact for GitHub Pages:</strong> Uploads the generated <code>result.json</code> as a Pages artifact.</li>
                <li><strong>Deploy to GitHub Pages:</strong> Publishes the artifact to GitHub Pages.</li>
            </ol>
            <div class="alert alert-info" role="alert">
                <strong>Important:</strong> <code>result.json</code> is NOT committed to the repository; it is dynamically generated and published by GitHub Actions.
            </div>
        </div>

        <div class="file-section">
            <h3>Accessing <code>result.json</code> on GitHub Pages</h3>
            <p>After a successful run of the GitHub Actions workflow, the <code>result.json</code> file will be published to your GitHub Pages site. You can typically find it at a URL like:</p>
            <p class="code-block"><code>https://&lt;YOUR_GITHUB_USERNAME&gt;.github.io/&lt;YOUR_REPO_NAME&gt;/result.json</code></p>
            <p>
                To enable GitHub Pages for your repository:
                <ol>
                    <li>Go to your repository on GitHub.</li>
                    <li>Navigate to <strong>Settings</strong> &gt; <strong>Pages</strong>.</li>
                    <li>Under "Build and deployment", set "Source" to <strong>GitHub Actions</strong>.</li>
                    <li>Ensure your workflow runs on the correct branch (e.g., <code>main</code>).</li>
                </ol>
            </p>
            <p>Once Pages is enabled and the workflow runs, you should be able to access the generated <code>result.json</code> through the provided URL pattern.</p>
        </div>

        <footer class="text-center mt-5 text-muted">
            <p>Generated for the specified brief requirements.</p>
        </footer>
    </div>

    <!-- Bootstrap JS CDN (optional, for components that need JS) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>